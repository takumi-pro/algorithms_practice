#!/bin/bash

# Script to easily create directories in the atcoder directory

ATCODER_DIR="/Users/takumi/Documents/algorithms-practice/atcoder"

# Check if atcoder directory exists
if [ ! -d "$ATCODER_DIR" ]; then
    echo "Error: atcoder directory not found at $ATCODER_DIR"
    exit 1
fi

# Function to create ABC contest directory
create_abc_dir() {
    local contest_num=$1
    local dir_name="abc_${contest_num}"
    local full_path="$ATCODER_DIR/$dir_name"
    
    if [ -d "$full_path" ]; then
        echo "Directory $dir_name already exists!"
    else
        mkdir -p "$full_path"
        echo "Created directory: $full_path"
    fi
    
    # Create files if --with-files option is specified
    if [ "$2" = "--with-files" ]; then
        local template_file="/Users/takumi/Documents/algorithms-practice/template.cpp"
        for problem in a b c d; do
            if [ -f "$full_path/${problem}.cpp" ]; then
                echo "File already exists: $full_path/${problem}.cpp"
            else
                if [ -f "$template_file" ]; then
                    cp "$template_file" "$full_path/${problem}.cpp"
                    echo "Created file: $full_path/${problem}.cpp (copied from main.cpp)"
                else
                    touch "$full_path/${problem}.cpp"
                    echo "Created file: $full_path/${problem}.cpp (empty - template not found)"
                fi
            fi
        done
    fi
}

# Function to create custom directory
create_custom_dir() {
    local dir_name=$1
    local full_path="$ATCODER_DIR/$dir_name"
    
    if [ -d "$full_path" ]; then
        echo "Directory $dir_name already exists!"
    else
        mkdir -p "$full_path"
        echo "Created directory: $full_path"
    fi
}

# Main script logic
if [ $# -eq 0 ]; then
    echo "Usage:"
    echo "  $0 abc <contest_number> [--with-files]  # Create ABC contest directory"
    echo "  $0 <directory_name>                      # Create custom directory"
    echo ""
    echo "Examples:"
    echo "  $0 abc 400                 # Creates abc_400/"
    echo "  $0 abc 400 --with-files    # Creates abc_400/ with a.cpp, b.cpp, c.cpp, d.cpp"
    echo "  $0 arc_150                 # Creates arc_150/"
    exit 1
fi

# Check if creating ABC directory
if [ "$1" = "abc" ]; then
    if [ -z "$2" ]; then
        echo "Error: Contest number required for ABC directories"
        echo "Usage: $0 abc <contest_number> [--with-files]"
        exit 1
    fi
    create_abc_dir "$2" "$3"
else
    # Create custom directory
    create_custom_dir "$1"
fi